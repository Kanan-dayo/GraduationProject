//------------------------------------------------------------------------------
//
//モジュールの基底クラス  [module_base.cpp]
//Author:Yoshiki Hosoya
//
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
//インクルード
//------------------------------------------------------------------------------
#include "module_base.h"
#include "module_parts_lamp.h"
#include "manager.h"
#include "renderer.h"
#include "camera.h"

//------------------------------------------------------------------------------
//静的メンバ変数の初期化
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
//マクロ
//------------------------------------------------------------------------------
#define LAMP_OFFSET_POS (D3DXVECTOR3(25.0f, 25.0f, -10.0f))
//------------------------------------------------------------------------------
//コンストラクタ
//------------------------------------------------------------------------------
CModule_Base::CModule_Base()
{
	m_bCanSelect = true;
	m_bModuleClearFlag = false;
}

//------------------------------------------------------------------------------
//デストラクタ
//------------------------------------------------------------------------------
CModule_Base::~CModule_Base()
{
	m_pLamp.reset();
}

//------------------------------------------------------------------------------
//ランプ生成
//------------------------------------------------------------------------------
void CModule_Base::CreateLamp()
{
	//ランプ生成
	m_pLamp = CModule_Parts_Base::Create_ModuleParts<CModule_Parts_Lamp>(LAMP_OFFSET_POS, GetMtxWorldPtr());
}

//------------------------------------------------------------------------------
//カメラを近づける
//------------------------------------------------------------------------------
void CModule_Base::CameraApproach()
{
	//カメラを近づける
	CManager::GetRenderer()->GetCamera()->ApproachCamera(GetPos());
}

//------------------------------------------------------------------------------
//モジュールクリア
//------------------------------------------------------------------------------
void CModule_Base::Module_Clear()
{
	//nullcheck
	if (m_pLamp)
	{
		m_pLamp->SetLampState(CModule_Parts_Lamp::LAMP_STATE::GREEN);
	}
}

//------------------------------------------------------------------------------
//モジュール失敗
//------------------------------------------------------------------------------
void CModule_Base::Module_Failed()
{
	//nullcheck
	if (m_pLamp)
	{
		m_pLamp->SetLampState(CModule_Parts_Lamp::LAMP_STATE::RED);
	}
}

